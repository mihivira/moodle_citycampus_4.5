{"version":3,"file":"reportes_uo.min.js","sources":["../src/reportes_uo.js"],"sourcesContent":["define([\n    'jquery',\n    'core/chart_builder',\n    'core/chart_output_chartjs',\n    'core/ajax',\n    'local_hoteles_city_dashboard/jspdf',\n\n], function($, Builder, Output, ajax, jspdf) {\n\n    var getData = function(uniqid, regions, type) {\n      ajax.call([{\n         methodname: 'local_hoteles_city_dashboard_reports_uo',\n         args: {\n           data: {\n               'regions': regions,\n               'type': type,\n           },\n         },\n      }])[0]\n      .done(function(response) {\n\n        var data = JSON.parse(response);\n\n        window.console.log(\"data:  \", data);\n\n        var table = document.getElementById(\"tbody\");\n        var thead = document.getElementById(\"hdata\");\n        document.getElementById(\"tittable\").innerHTML = data.graph.title;\n        if (data.type == \"users-download\") {\n          document.getElementById(\"cont-table\").className = \"col-12\";\n          document.getElementById(\"cont-graph\").className = \"d-none\";\n          // Obtener el thead donde se agregarán los encabezados\n          thead.innerHTML = \"\";\n          // Crear una fila de encabezado <tr>\n          var filaEncabezado = document.createElement(\"tr\");\n\n\n        } else {\n          document.getElementById(\"cont-table\").className = \"col-12\";\n          document.getElementById(\"cont-graph\").className = \"col-12\";\n          // Obtener el thead donde se agregarán los encabezados\n          thead.innerHTML = \"\";\n          // Crear una fila de encabezado <tr>\n          var filaEncabezado = document.createElement(\"tr\");\n\n          var heads = ['Nombre', '% Completado', '% No completado'];\n\n          heads.forEach(function(head) {\n            var celdaEncabezado = document.createElement(\"th\");\n            celdaEncabezado.textContent = head;\n            filaEncabezado.appendChild(celdaEncabezado);\n          });\n\n          // Agregar la fila de encabezado al thead\n          thead.appendChild(filaEncabezado);\n\n        }\n\n        data.table.elements.forEach(function(element, index) {\n          //window.console.log(element);\n\n            if (data.type == \"users-download\") {\n              window.console.log(\"users-download\");\n              var fila = document.createElement(\"tr\");\n              // Iterar sobre los datos y crear celdas en la fila\n              if (index < 1) {\n                for (var head in element) {\n                  var celdaEncabezado = document.createElement(\"th\");\n                  celdaEncabezado.textContent = head;\n                  filaEncabezado.appendChild(celdaEncabezado);\n                }\n              }\n              // Agregar la fila de encabezado al thead\n              thead.appendChild(filaEncabezado);\n\n              for (var campo in element) {\n\n                var celda = document.createElement(\"td\");\n                celda.textContent = element[campo];\n                fila.appendChild(celda);\n                table.appendChild(fila);\n              }\n            } else {\n              window.console.log(\"table\");\n              var row = table.insertRow(index);\n\n              // Insert new cells (<td> elements) at the 1st and 2nd position of the \"new\" <tr> element:\n              var cell1 = row.insertCell(0);\n              var cell2 = row.insertCell(1);\n              var cell3 = row.insertCell(2);\n\n\n              // Add some text to the new cells:\n              if (element.type === 'courses') {\n                cell1.innerHTML = '<a class=\"link-uo\" href=\"#\" data-item=\"' + element.id + '\">' + element.name + '</a>';\n              } else if (element.type === 'regions-cert') {\n                cell1.innerHTML = '<a class=\"link-uo\" href=\"#\" data-item=\"' + element.name + \",\" + element.course\n                + '\" data-type=\"' + element.type + '\">'\n                + element.name + '</a>';\n              } else if(element.type === 'uos'){\n                cell1.innerHTML = element.name;\n              } else {\n                cell1.innerHTML = '<a class=\"link-uo\" href=\"#\" data-item=\"' + element.name + '\">' + element.name + '</a>';\n              }\n              cell2.innerHTML = element.percentage;\n              \n              if(element.percentage > 0){\n                cell3.innerHTML = (100 - Number(element.percentage)).toFixed(2);\n              } else {\n                cell3.innerHTML = \"N/A\";\n                cell2.innerHTML = \"N/A\";\n              }\n              \n            }\n        });\n\n        var tablaLlenaEvent = new Event('tablaLlena', {bubbles: true, cancelable: true});\n        document.getElementById('tdata').dispatchEvent(tablaLlenaEvent);\n\n        var chartArea = $('#chart-area-' + uniqid);\n        var chartImage = chartArea.find('.chart-image');\n\n        Builder.make(data.graph)\n        .then(function(ChartInst) {\n          new Output(chartImage, ChartInst);\n          return;\n        })\n        .fail(function(err) {\n          window.console.log(err);\n            return;\n        });\n\n      });\n    };\n\n    return {\n\n      init: function(uniqid, regions, type) {\n        getData(uniqid, regions, type);\n\n      },\n    };\n});"],"names":["define","$","Builder","Output","ajax","jspdf","init","uniqid","regions","type","call","methodname","args","data","done","response","JSON","parse","window","console","log","table","document","getElementById","thead","innerHTML","graph","title","className","filaEncabezado","createElement","forEach","head","celdaEncabezado","textContent","appendChild","elements","element","index","fila","campo","celda","row","insertRow","cell1","insertCell","cell2","cell3","id","name","course","percentage","Number","toFixed","tablaLlenaEvent","Event","bubbles","cancelable","dispatchEvent","chartImage","find","make","then","ChartInst","fail","err","getData"],"mappings":"AAAAA,kDAAO,CACH,SACA,qBACA,4BACA,YACA,uCAED,SAASC,EAAGC,QAASC,OAAQC,KAAMC,aAgI3B,CAELC,KAAM,SAASC,OAAQC,QAASC,OAhIpB,SAASF,OAAQC,QAASC,MACtCL,KAAKM,KAAK,CAAC,CACRC,WAAY,0CACZC,KAAM,CACJC,KAAM,SACSL,aACHC,UAGb,GACHK,MAAK,SAASC,cAETF,KAAOG,KAAKC,MAAMF,UAEtBG,OAAOC,QAAQC,IAAI,UAAWP,UAE1BQ,MAAQC,SAASC,eAAe,SAChCC,MAAQF,SAASC,eAAe,YACpCD,SAASC,eAAe,YAAYE,UAAYZ,KAAKa,MAAMC,MAC1C,kBAAbd,KAAKJ,KAA0B,CACjCa,SAASC,eAAe,cAAcK,UAAY,SAClDN,SAASC,eAAe,cAAcK,UAAY,SAElDJ,MAAMC,UAAY,OAEdI,eAAiBP,SAASQ,cAAc,WAI5CR,SAASC,eAAe,cAAcK,UAAY,SAClDN,SAASC,eAAe,cAAcK,UAAY,SAElDJ,MAAMC,UAAY,GAEdI,eAAiBP,SAASQ,cAAc,MAEhC,CAAC,SAAU,eAAgB,mBAEjCC,SAAQ,SAASC,UACjBC,gBAAkBX,SAASQ,cAAc,MAC7CG,gBAAgBC,YAAcF,KAC9BH,eAAeM,YAAYF,oBAI7BT,MAAMW,YAAYN,gBAIpBhB,KAAKQ,MAAMe,SAASL,SAAQ,SAASM,QAASC,UAGzB,kBAAbzB,KAAKJ,KAA0B,CACjCS,OAAOC,QAAQC,IAAI,sBACfmB,KAAOjB,SAASQ,cAAc,SAE9BQ,MAAQ,MACL,IAAIN,QAAQK,QAAS,KACpBJ,gBAAkBX,SAASQ,cAAc,MAC7CG,gBAAgBC,YAAcF,KAC9BH,eAAeM,YAAYF,qBAM1B,IAAIO,SAFThB,MAAMW,YAAYN,gBAEAQ,QAAS,KAErBI,MAAQnB,SAASQ,cAAc,MACnCW,MAAMP,YAAcG,QAAQG,OAC5BD,KAAKJ,YAAYM,OACjBpB,MAAMc,YAAYI,WAEf,CACLrB,OAAOC,QAAQC,IAAI,aACfsB,IAAMrB,MAAMsB,UAAUL,OAGtBM,MAAQF,IAAIG,WAAW,GACvBC,MAAQJ,IAAIG,WAAW,GACvBE,MAAQL,IAAIG,WAAW,GAIN,YAAjBR,QAAQ5B,KACVmC,MAAMnB,UAAY,0CAA4CY,QAAQW,GAAK,KAAOX,QAAQY,KAAO,OACvE,iBAAjBZ,QAAQ5B,KACjBmC,MAAMnB,UAAY,0CAA4CY,QAAQY,KAAO,IAAMZ,QAAQa,OACzF,gBAAkBb,QAAQ5B,KAAO,KACjC4B,QAAQY,KAAO,OACQ,QAAjBZ,QAAQ5B,KAChBmC,MAAMnB,UAAYY,QAAQY,KAE1BL,MAAMnB,UAAY,0CAA4CY,QAAQY,KAAO,KAAOZ,QAAQY,KAAO,OAErGH,MAAMrB,UAAYY,QAAQc,WAEvBd,QAAQc,WAAa,EACtBJ,MAAMtB,WAAa,IAAM2B,OAAOf,QAAQc,aAAaE,QAAQ,IAE7DN,MAAMtB,UAAY,MAClBqB,MAAMrB,UAAY,eAMtB6B,gBAAkB,IAAIC,MAAM,aAAc,CAACC,SAAS,EAAMC,YAAY,IAC1EnC,SAASC,eAAe,SAASmC,cAAcJ,qBAG3CK,WADY1D,EAAE,eAAiBM,QACRqD,KAAK,gBAEhC1D,QAAQ2D,KAAKhD,KAAKa,OACjBoC,MAAK,SAASC,eACT5D,OAAOwD,WAAYI,cAGxBC,MAAK,SAASC,KACb/C,OAAOC,QAAQC,IAAI6C,WAUrBC,CAAQ3D,OAAQC,QAASC"}