define(["jquery","jqueryui","mod_icontent/cookiehandler"],function(n,t,a){function e(){var t={action:"loadpage",id:n(this).attr("data-cmid"),pagenum:n(this).attr("data-pagenum"),sesskey:n(this).attr("data-sesskey")};n(".icontent-page").children(".fulltextpage").prepend(n("<div />").addClass("loading").html('<img src="pix/loading.gif" alt="Loading" class="img-loading" />')).css("opacity","0.5"),o(t.pagenum),t="&"+n.param(t),n.ajax({type:"POST",dataType:"json",url:"ajax.php",data:t,success:function(t){"0"!==t.transitioneffect?(n(".icontent-page").hide(),n(".icontent-page").html(t.fullpageicontent),n(".icontent-page").show(t.transitioneffect,1e3)):n(".icontent-page").html(t.fullpageicontent),i();var a=n(".icontent-buttonbar .btn-previous-page"),e=n(".icontent-buttonbar .btn-next-page");t.previous?(a.removeAttr("disabled"),a.attr("data-pagenum",t.previous)):a.prop("disabled",!0),t.next?(e.removeAttr("disabled"),e.attr("data-pagenum",t.next)):e.prop("disabled",!0)}})}function i(){"yes"==a.cookie("highcontrast")&&n(".fulltextpage").addClass("highcontrast").css({"background-color":"#000000","background-image":"none"})}function o(t){n(".load-page").removeClass("active"),n(".btn-icontent-page").removeAttr("disabled"),n(".page"+t).addClass("active"),n(".page"+t).prop("disabled",!0)}return{init:function(){i(),o(n(".fulltextpage").attr("data-pagenum")),n(".load-page").click(e)}}});